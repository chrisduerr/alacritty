language: rust

sudo: required
services:
  - docker

git:
  depth: 1

os:
  - linux
  - osx
  - windows

rust:
  - stable
  - nightly

matrix:
  fast_finish: true
  allow_failures:
    - rust: nightly
    - os: windows

install: ci/install.sh
script: ci/script.sh
before_deploy: ci/before_deploy.sh

deploy:
  provider: releases
  api_key:
    secure: sxc99y3OOQBwCmTZeE6KLNlcghqiiFqU8hxh1ii8BdzmGh74b00FMSy/m50L+wAJ1iKr4l0CdUbkcV+INVlHSo1Zk0Vq4fC1ii4mHgBX75HA4QEk4Y9WJUqDU7dV5ETFtt1prNJZ3l2h1JWhsabCRlGrvJnza9wBwgJugw7CM73J0RgRDYttpc1qStdE6Mfo7WH19V60jLr/V3go6IUiWZKphONalwACYjflmMhPlVnTaiE/LZsECyF8wXXmnKFOQqJServjgBSIYH2CpjIkbeb4xqMpZpKN+zHHf0Bt0D3wqIb1dx8VSGNXZsxVWtnPur5MpFCGiZWM7ZF1Rx/z+2MRonR4oEa/QRSC1OqNFT95KeCyLytx+8uQN/+/rbXpuLQzf6oLM2c1KX3rVuYmAnzDeEzNVycxXdmWKtKcnYjJ/LXYF05PdyACu9k9H8pS2RPvg+F8Z3EmLWJhvZhA4sQsJxeCpVlebAK2M6+Rt+cUSqdz2PLSnTEIPJt/eiFP0wKiigtoc1LHET+GUWvrekSxzxO3IDOX7+qZGqys/JbZtL0WHecXC0aUXiUnt4QpePgsjEKrdQ+bmkWB7j+ABQh+ypfnzZaOR8DEl5Z9HXVJlkeoACyh4HMZCyEZdQfSXIfQ8xsR/BOoIWWPNIBHV6+JAil9qDHjY5nDE/5BkEw=
  skip_cleanup: true
  file_glob: true
  file: "./target/deploy/*"
  on:
    tags: true
    rust: stable
